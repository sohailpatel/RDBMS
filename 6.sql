create or replace view montly_details as
select orders.orderdate,group_concat(productname.name)as Product_NAme,group_concat(products.price)as Price,group_concat(orders.quantity)as Quantity,sum(orders.cost)as Total,(select userdetails.name from userdetails where userdetails.id in (orders.orderby)) as UserName,(select userdetails.email from userdetails where userdetails.id in (orders.orderby))as Email from orders,productname,products where orders.productid=products.id and orders.orderdate BETWEEN NOW() - INTERVAL 30 DAY AND NOW() group by orders.id;
